



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="CC4 Compiladores - Universidad Galileo">
      
      
        <link rel="canonical" href="https://cc-4.github.io/proyectos/generacion-de-codigo/">
      
      
        <meta name="author" content="CC-4">
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Generación de Código - Compiladores</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/emoji.css">
    
      <link rel="stylesheet" href="../../stylesheets/kbd.css">
    
      <link rel="stylesheet" href="../../convnet_demo/style.css">
    
      <link rel="stylesheet" href="../../stylesheets/button.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#generacion-de-codigo" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://cc-4.github.io/" title="Compiladores" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Compiladores
              </span>
              <span class="md-header-nav__topic">
                Generación de Código
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/CC-4/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      cc-4
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://cc-4.github.io/" title="Compiladores" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Compiladores
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/CC-4/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      cc-4
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Inicio" class="md-nav__link">
      Inicio
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Laboratorios
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Laboratorios
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/untitled/" title="Lab 1 (COOL)" class="md-nav__link">
      Lab 1 (COOL)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-2/" title="Lab 2 (Lexer)" class="md-nav__link">
      Lab 2 (Lexer)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-3/" title="Lab 3 (RDP)" class="md-nav__link">
      Lab 3 (RDP)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-4/" title="Lab 4 (JCUP)" class="md-nav__link">
      Lab 4 (JCUP)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-5/" title="Lab 5 (Symbol Table)" class="md-nav__link">
      Lab 5 (Symbol Table)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-6-analisis-semantico-i/" title="Lab 6 (Análisis Semántico I)" class="md-nav__link">
      Lab 6 (Análisis Semántico I)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-7-analisis-semantico-ii/" title="Lab 7 (Análisis Semántico II)" class="md-nav__link">
      Lab 7 (Análisis Semántico II)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-8-risc-v/" title="Lab 8 (RISC-V)" class="md-nav__link">
      Lab 8 (RISC-V)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-9-codegen/" title="Lab 9 (CodeGen I)" class="md-nav__link">
      Lab 9 (CodeGen I)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-10-codegen-ii/" title="Lab 10 (CodeGen II)" class="md-nav__link">
      Lab 10 (CodeGen II)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../laboratorios/lab-11-optimizaciones/" title="Lab 11 (Optimizaciones)" class="md-nav__link">
      Lab 11 (Optimizaciones)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Proyectos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Proyectos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../instalacion-material/" title="Instalación Material" class="md-nav__link">
      Instalación Material
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analisis-lexico/" title="Análisis Léxico" class="md-nav__link">
      Análisis Léxico
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analisis-sintactico/" title="Análisis Sintáctico" class="md-nav__link">
      Análisis Sintáctico
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analisis-semantico/" title="Análisis Semántico" class="md-nav__link">
      Análisis Semántico
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Generación de Código
      </label>
    
    <a href="./" title="Generación de Código" class="md-nav__link md-nav__link--active">
      Generación de Código
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduccion" title="1. Introducción" class="md-nav__link">
    1. Introducción
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-ambiente" title="2. Ambiente" class="md-nav__link">
    2. Ambiente
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-archivos-y-directorios" title="3. Archivos y Directorios" class="md-nav__link">
    3. Archivos y Directorios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-diseno" title="4. Diseño" class="md-nav__link">
    4. Diseño
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-runtime-error-checking" title="4.1 Runtime Error Checking" class="md-nav__link">
    4.1 Runtime Error Checking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-garbage-collection" title="4.2 Garbage Collection" class="md-nav__link">
    4.2 Garbage Collection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-probando-su-codegen" title="5. Probando su CodeGen" class="md-nav__link">
    5. Probando su CodeGen
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-jupiter" title="5.1 Jupiter" class="md-nav__link">
    5.1 Jupiter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-autograder" title="6. Autograder" class="md-nav__link">
    6. Autograder
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduccion" title="1. Introducción" class="md-nav__link">
    1. Introducción
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-ambiente" title="2. Ambiente" class="md-nav__link">
    2. Ambiente
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-archivos-y-directorios" title="3. Archivos y Directorios" class="md-nav__link">
    3. Archivos y Directorios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-diseno" title="4. Diseño" class="md-nav__link">
    4. Diseño
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-runtime-error-checking" title="4.1 Runtime Error Checking" class="md-nav__link">
    4.1 Runtime Error Checking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-garbage-collection" title="4.2 Garbage Collection" class="md-nav__link">
    4.2 Garbage Collection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-probando-su-codegen" title="5. Probando su CodeGen" class="md-nav__link">
    5. Probando su CodeGen
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-jupiter" title="5.1 Jupiter" class="md-nav__link">
    5.1 Jupiter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-autograder" title="6. Autograder" class="md-nav__link">
    6. Autograder
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/CC-4/edit/master/page/es/docs/proyectos/generacion-de-codigo.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="generacion-de-codigo">Generación de Código<a class="headerlink" href="#generacion-de-codigo" title="Permanent link">&para;</a></h1>
<p><img alt="" src="../.gitbook/assets/codegen.png" /></p>
<h2 id="1-introduccion">1. Introducción<a class="headerlink" href="#1-introduccion" title="Permanent link">&para;</a></h2>
<p>En esta asignación, ustedes van a implementar un generador de código para COOL. Cuando hayan terminado satisfactoriamente esta parte, ustedes van a tener un compilador de COOL totalmente funcional.</p>
<div class="admonition note"> <p class=admonition-title>Ultima fase</p><p>
Esperamos que se den cuenta, que al finalizar esta fase, resolvieron un problema de ingeniería sustancialmente complejo. De ahora en adelante cualquier reto en cuestión de diseño e implementación debería de ser por lo menos un poco más fácil.</p></div>
<p>El generador de código hace uso del <em>Abstract Syntax Tree</em> (AST) construido durante la fase 2 del proyecto (Parser) y la fase 3 del proyecto (Semantic). Su generador de código debería de producir código de ensamblador, que representa cualquier programa de COOL correcto para la arquitectura <strong>RISC-V</strong>.</p>
<p>En esta fase no hay recuperación de errores, en la generación de código ya podemos estar seguros de que cualquier programa erroneo de COOL ya ha sido detectado en las fases anteriores del compilador (Lexer, Parser, Semantic).</p>
<p>Así como en la fase de análisis semántico, esta última parte tiene decisiones de diseño que ustedes tienen que pensar bien para lograr completarla. Su programa va estar correcto si el código generado funciona correctamente, ¿cómo lo van a lograr? ustedes tienen que ver que camino seguir, que decisiones tomar, que técnicas utilizar, etc. Les recomendamos algunos convenios que nosotros creemos les van a hacer la vida más fácil, pero no están obligados a seguir nuestras recomendaciones. Esta última parte, comparte mucha de la infrastructura de la fase anterior. <strong>Por favor, empiecen lo más pronto posible</strong>.</p>
<p>Es bastante importante que para que ustedes puedan lograr generar código correctamente, ustedes tengan claro ya el compartamiento interno de COOL, como interactura con el runtime system (<em><strong>runtime.s</strong></em>) y el código generado. El comportamiento esperado es el mismo que cuando compilen con <b>coolc-rv</b>. La interfaz entre el runtime system y el código generado está dado en <em><strong>runtime.s</strong></em> y el manual <em>Cool Runtime System</em>. Revisen esos documentos y archivos para que tengan una clara visión de todos los requerimientos del runtime system en el código generado. Hay un montón de información en esta asignación y en los documentos mencionados, y ustedes tienen que saber de estos para poder generar código de manera correcta. Por favor lean <em>cuidadosamente</em> para entender a detalle todo.</p>
<h2 id="2-ambiente">2. Ambiente<a class="headerlink" href="#2-ambiente" title="Permanent link">&para;</a></h2>
<p>Debe tener instalado <b>coolc-rv</b> y <b>jupitercl</b>, si no los tiene, revise la seccion de <b>Instalacion de material</b>.</p>

<p>Para comprobar que todo este instalado correctamente, compilen y corran un programa simple de COOL:</p>
<div class="codehilite"><pre><span></span><span class="o">--</span><span class="p">(</span><span class="n">main</span><span class="o">.</span><span class="n">cl</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Main</span> <span class="n">inherits</span> <span class="n">IO</span> <span class="p">{</span>

  <span class="n">main</span><span class="p">():</span> <span class="n">Object</span> <span class="p">{</span>
    <span class="n">out_string</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">)</span>
  <span class="p">};</span>

<span class="p">};</span>
</pre></div>

<p>Entonces utilizando el compilador que acabamos de instalar, podemos generar código de RISC-V:</p>
<div class="codehilite"><pre><span></span>coolc-rv main.cl <span class="c1"># genera un archivo main.s</span>
</pre></div>

<p>Por último pueden probar el programa de la siguiente manera:</p>
<div class="codehilite"><pre><span></span>jupitercl main.s
hello world
COOL program successfully executed

Jupiter: exit<span class="o">(</span><span class="m">0</span><span class="o">)</span>
</pre></div>

<div class="admonition note"> <p class=admonition-title>jupitercl</p><p>Noten que se está haciendo uso del comando <em><strong>jupitercl</strong></em>, este a diferencia del comando <em><strong>jupiter</strong></em> carga automáticamente el runtime system de COOL.</p></div>
<h2 id="3-archivos-y-directorios">3. Archivos y Directorios<a class="headerlink" href="#3-archivos-y-directorios" title="Permanent link">&para;</a></h2>
<p>Obtenga sus archivos base ejecutando el siguiente comando</p>
<div class="codehilite"><pre><span></span>make -f /usr/class/cc4/assignments/PA4/Makefile</pre></div>

<p>Casi todos estos archivos han sido explicados en las fases anteriores del proyecto. Esta es una lista de los archivos que ustedes tal vez quieran modificar. Ustedes ya tienen que estar familiarizados con la mayoría de estos archivos por las fases anteriores.</p>
<ul>
<li><strong>CgenClassTable.java</strong> y <strong>CgenNode.java</strong>: Estos archivos proveen una implementación del grafo de herencia para el generador de código. Ustedes van a tener que completar <code>CgenClassTable</code> para poder construir su generador de código. Ustedes pueden utilizar el código que se les provee o pueden reemplazarlo con el suyo o con el que hicieron en la fase anterior.</li>
<li><strong>StringSymbol.java</strong>, <strong>IntSymbol.java</strong>, y <strong>BoolConst.java</strong>: Estos archivos proveen soporte para las constantes de COOL. Ustedes van a tener que completar el método para generar definiciones de estas constantes.</li>
<li><strong>cool-tree.java</strong>: Este archivo contiene la definición del los nodos del AST. Ustedes van a tener que añadir rutinas de generación de código <code>code(PrintStream)</code> para todas las expresiones en este archivo. <strong>El generador de código es mandado a llamar, empezando por</strong> <code>code(PrintStream)</code> <strong>que está en la clase program</strong>. Ustedes tal vez quieran añadir más métodos, pero no modifiquen los métodos ya existentes.</li>
<li><strong>TreeConstants.java</strong>: Como antes, este archivo define algunas constantes útiles, siéntanse libres de añadir las suyas y lo que quieran.</li>
<li><strong>CgenSupport.java</strong>: Este archivo contiene soporte general para generar código. Van a encontrar una serie de funciones que se vuelven bastantes útiles para emitir instrucciones de RISC-V, aquí está todo lo que necesitan. Pueden añadir también las que ustedes quieran, pero no modifiquen nada de lo que ya está definido.</li>
<li><strong>example.cl</strong>: Este es su archivo de prueba para ver si lo que genera su generador de código funciona correctamente. Hagan bastantes pruebas con este archivo como lo requieran.</li>
</ul>
<h2 id="4-diseno">4. Diseño<a class="headerlink" href="#4-diseno" title="Permanent link">&para;</a></h2>
<p>Antes de continuar, les sugerimos que de verdad lean el documento The Cool Runtime System para que estén cómodos con los requerimientos que necesita implementar su generador de código impuestos por el runtime system. En consideración a su diseño, así a grandes rasgos, su generador de código deberá hacer las siguientes tareas:</p>
<ul>
<li>Determinar y emitir código para las constantes globales, como los prototipos de objeto.</li>
<li>Determinar y emitir código para las tablas globales, como la <code>class_nameTab</code>, la <code>class_objTab</code> y las dispatch tables.</li>
<li>Determinar y emitir código para la inicialización de los métodos y atributos de cada clase.</li>
<li>Determinar y emitir código para cada método de cada clase.</li>
</ul>
<p>Hay varias maneras posibles de implementar un generador de código. Una estrategia razonable es hacer el generador de código en dos pasadas. La primera pasada decide el layout para cada clase, particularmente el offset en donde cada atributo es guardado en un objeto. Utilizando esta información, la segunda pasada recursivamente visita cada feature y genera código de un stack machine para cada expresión.</p>
<p>Hay un número de cosas que ustedes tienen que mantener en mente mientras diseñan su generador de código:</p>
<ul>
<li>Su generador de código tiene que funcionar correctamente con el Runtime de COOL (<em><strong>runtime.s</strong></em>), que es explicado a detalle en <em>Cool Runtime System Manual</em>.</li>
<li>Ustedes tiene que tener claro como funciona la semántica operacional del runtime de COOL. La semántica es descrita informalmente en la primera parte del <em>Cool Reference Manual</em> y una descripción precisa de cómo los programas de COOL deberían de comportarse está explicada en la sección 13 del manual de COOL.</li>
<li>Deberían entender el set de instrucciones de RISC-V, y tener una vista general de las operaciones que se pueden efectuar con <code>Jupiter</code>.</li>
<li>Ustedes tienen que decidir que invariantes su generador de código puede esperar u observar (es decir, qué registros se van a salvar, cuales se pueden sobreescribir, convenios, etc). Ustedes van a encontrar bastante útil, ver la información que se les enseño en clase.</li>
</ul>
<h3 id="41-runtime-error-checking">4.1 Runtime Error Checking<a class="headerlink" href="#41-runtime-error-checking" title="Permanent link">&para;</a></h3>
<p>Al final del manual de COOL existe una lista de errores que pueden terminar un programa antes de lo esperado. De esta lista su generador de código debería de ser capaz de atrapar las primeras tres: <strong>dispatch on void</strong>, <strong>case on void</strong> y <strong>missing branch</strong> e imprimir un mensaje de error antes de abortar. Atrapar errores de <strong>substring out of range</strong> y <strong>heap overflow</strong> es responsabilidad del runtime system que está en <strong>runtime.s</strong>. Ya que estamos utilizando RISC-V, es necesario que validen en el código generado la división entre 0, mandando a llamar a <strong>_div_by_zero</strong> que está definida en <strong>runtime.s</strong>, vean como <em><strong>coolc-rv</strong></em> maneja estos casos.</p>
<h3 id="42-garbage-collection">4.2 Garbage Collection<a class="headerlink" href="#42-garbage-collection" title="Permanent link">&para;</a></h3>
<p>El equipo de CC-4 que tradujo el runtime de COOl de MIPS a RISC-V, no implementó un garbage collector complejo como el original que está en el runtime de MIPS (un <em>garbage collector generacional</em>), debido al tiempo y porque ustedes realmente no van a interactuar mucho con el garbage collector en este curso (incluso si hicieran esta fase para la versión de MIPS). El código que tienen que tener para que el GC funcione correctamente ya se las damos en el código base y no tienen que preocuparse por esto, pero si se tienen que preocupar porque su generador de código funcione bien y sea compatible con el runtime system de COOL.</p>
<h2 id="5-probando-su-codegen">5. Probando su CodeGen<a class="headerlink" href="#5-probando-su-codegen" title="Permanent link">&para;</a></h2>
<p>Van a necesitar un analizador léxico, sintáctico y semántico para probar su generador de código. Pueden utilizar sus implementaciones a estas fases o utilizar las que nosotros les proveemos. Por defecto, las que nosotros les proveemos son utilizadas, para cambiar este comportamiento tienen que cambiar los archivos <code>lexer</code>, <code>parser</code> y <code>semant</code> con sus propias implementaciones. De todas maneras el autograder principal de este proyecto utiliza los analizadores del compilador de COOL <strong>coolc</strong>.</p>
<p>Ustedes van a tener que correr su generador de código utilizando <code>./mycoolc</code>, que es un shell script que pega el generador de código que ustedes implementaron con el resto de fases. Tomen en cuenta que <code>./mycoolc</code> puede tomar una bandera -c para depurar el generador de código, utilizando esta bandera, se cambia la bandera debug a verdadero, que está en <strong>Flags.java</strong>. Agregar código para producir información de depuración es tarea de ustedes si quieren utilizarlo.</p>
<h3 id="51-jupiter">5.1 Jupiter<a class="headerlink" href="#51-jupiter" title="Permanent link">&para;</a></h3>
<p>El ejecutable de Jupiter <code>jupitercl</code> es el simulador para la arquitectura RISC-V en donde pueden probar su generador de código. Tiene muchas funcionalidades que les permite examinar el estado de la memoria, símbolos globales y locales, registros, etc del programa. Ustedes también pueden poner breakpoints y hacer step de su programa. Para poder utilizar el debugger de Jupiter ustedes pueden hacer lo siguiente:</p>
<div class="codehilite"><pre><span></span>jupitercl -g &lt;archivo.s&gt;
&gt;&gt;&gt; help
Available commands:

[General Commands]
 help/?                - show this help message
 exit/quit/q           - exit the simulator and debugger
 !                     - execute previous command

[Display]
 rvi                   - print all RVI registers
 rvi &lt;reg&gt;             - print RVI register reg
 rvf                   - print all RVF registers
 rvf &lt;reg&gt;             - print RVF register reg
 memory &lt;addr&gt;         - print 12 x 4 cells of memory starting at the given address
 memory &lt;addr&gt; &lt;rows&gt;  - print rows x 4 cells of memory starting at the given address
 globals               - print global symbol table
 locals                - print local symbol tables

[Execution Control]
 step/s                - continue until another instruction reached
 backstep/b            - back to the previous instruction
 continue/c            - continue running
 reset                 - reset

[Breakpoints]
 break &lt;addr&gt;          - set a breakpoint at the given address
 clear                 - delete all breakpoints
 delete &lt;addr&gt;         - delete breakpoint at the given address
 list                  - show defined breakpoints
</pre></div>

<h2 id="6-autograder">6. Autograder<a class="headerlink" href="#6-autograder" title="Permanent link">&para;</a></h2>


<p>Descargue el autograder en la misma carpeta donde tiene su cuarta fase:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>wget https://raw.githubusercontent.com/CC-4/cc-4.github.io/master/projects/grading/pa4-grading.py
chmod +x pa4-grading.py
</pre></div> </td></tr></table> <p>Luego ejecute el siguiente comando:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>./pa4-grading.pl
</pre></div> </td></tr></table> <p>Si quiere probar todas sus fases juntas, utilice el siguiente autograder:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>wget https://raw.githubusercontent.com/CC-4/cc-4.github.io/master/projects/grading/pa4-grading-all.sh
chmod +x pa4-grading-all.sh
</pre></div> </td></tr></table> <p>Luego ejecute el siguiente comando:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>./pa4-grading-all.sh
</pre></div> </td></tr></table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../analisis-semantico/" title="Análisis Semántico" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                Análisis Semántico
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            CC-4
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/CC-4" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b41f3d20.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../../assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../js/latex.js"></script>
      
        <script src="../../js/python.js"></script>
      
    
    
      
    
  </body>
</html>
