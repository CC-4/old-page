



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="CC4 Compiladores - Universidad Galileo">
      
      
        <link rel="canonical" href="https://cc-4.github.io/laboratorios/lab-6-analisis-semantico-i/">
      
      
        <meta name="author" content="CC-4">
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Lab 6 (Análisis Semántico I) - Compiladores</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/emoji.css">
    
      <link rel="stylesheet" href="../../stylesheets/kbd.css">
    
      <link rel="stylesheet" href="../../convnet_demo/style.css">
    
      <link rel="stylesheet" href="../../stylesheets/button.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#lab-6-40analisis-semantico-i41" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://cc-4.github.io/" title="Compiladores" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Compiladores
              </span>
              <span class="md-header-nav__topic">
                Lab 6 (Análisis Semántico I)
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/CC-4/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      cc-4
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://cc-4.github.io/" title="Compiladores" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Compiladores
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/CC-4/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      cc-4
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Inicio" class="md-nav__link">
      Inicio
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Laboratorios
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Laboratorios
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../untitled/" title="Lab 1 (COOL)" class="md-nav__link">
      Lab 1 (COOL)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-2/" title="Lab 2 (Lexer)" class="md-nav__link">
      Lab 2 (Lexer)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-3/" title="Lab 3 (RDP)" class="md-nav__link">
      Lab 3 (RDP)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-4/" title="Lab 4 (JCUP)" class="md-nav__link">
      Lab 4 (JCUP)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-5/" title="Lab 5 (Symbol Table)" class="md-nav__link">
      Lab 5 (Symbol Table)
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Lab 6 (Análisis Semántico I)
      </label>
    
    <a href="./" title="Lab 6 (Análisis Semántico I)" class="md-nav__link md-nav__link--active">
      Lab 6 (Análisis Semántico I)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-ciclos-en-grafos" title="1. Ciclos en Grafos:" class="md-nav__link">
    1. Ciclos en Grafos:
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-que-tienen-que-hacer" title="1.1 ¿Qué tienen que hacer?" class="md-nav__link">
    1.1 ¿Qué tienen que hacer?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-autograder" title="1.2 Autograder" class="md-nav__link">
    1.2 Autograder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-analisis-semantico-del-lenguaje-viper" title="2. Análisis Semántico del lenguaje Viper" class="md-nav__link">
    2. Análisis Semántico del lenguaje Viper
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-lenguaje-viper" title="2.1 Lenguaje Viper" class="md-nav__link">
    2.1 Lenguaje Viper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-reglas-de-inferencia-del-lenguaje-viper" title="2.2 Reglas de inferencia del lenguaje Viper" class="md-nav__link">
    2.2 Reglas de inferencia del lenguaje Viper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-que-tienen-que-hacer" title="2.3 ¿Qué tienen que hacer?" class="md-nav__link">
    2.3 ¿Qué tienen que hacer?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-implementacion" title="2.4 Implementación" class="md-nav__link">
    2.4 Implementación
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analisis-de-function" title="Análisis de Function" class="md-nav__link">
    Análisis de Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constantes" title="Constantes" class="md-nav__link">
    Constantes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operaciones-aritmeticas" title="Operaciones Aritméticas" class="md-nav__link">
    Operaciones Aritméticas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return" title="Return" class="md-nav__link">
    Return
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-autograder" title="2.5 Autograder" class="md-nav__link">
    2.5 Autograder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-7-analisis-semantico-ii/" title="Lab 7 (Análisis Semántico II)" class="md-nav__link">
      Lab 7 (Análisis Semántico II)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-8-risc-v/" title="Lab 8 (RISC-V)" class="md-nav__link">
      Lab 8 (RISC-V)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-9-codegen/" title="Lab 9 (CodeGen I)" class="md-nav__link">
      Lab 9 (CodeGen I)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-10-codegen-ii/" title="Lab 10 (CodeGen II)" class="md-nav__link">
      Lab 10 (CodeGen II)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab-11-optimizaciones/" title="Lab 11 (Optimizaciones)" class="md-nav__link">
      Lab 11 (Optimizaciones)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Proyectos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Proyectos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../proyectos/instalacion-material/" title="Instalación Material" class="md-nav__link">
      Instalación Material
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../proyectos/analisis-lexico/" title="Análisis Léxico" class="md-nav__link">
      Análisis Léxico
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../proyectos/analisis-sintactico/" title="Análisis Sintáctico" class="md-nav__link">
      Análisis Sintáctico
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../proyectos/analisis-semantico/" title="Análisis Semántico" class="md-nav__link">
      Análisis Semántico
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../proyectos/generacion-de-codigo/" title="Generación de Código" class="md-nav__link">
      Generación de Código
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-ciclos-en-grafos" title="1. Ciclos en Grafos:" class="md-nav__link">
    1. Ciclos en Grafos:
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-que-tienen-que-hacer" title="1.1 ¿Qué tienen que hacer?" class="md-nav__link">
    1.1 ¿Qué tienen que hacer?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-autograder" title="1.2 Autograder" class="md-nav__link">
    1.2 Autograder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-analisis-semantico-del-lenguaje-viper" title="2. Análisis Semántico del lenguaje Viper" class="md-nav__link">
    2. Análisis Semántico del lenguaje Viper
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-lenguaje-viper" title="2.1 Lenguaje Viper" class="md-nav__link">
    2.1 Lenguaje Viper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-reglas-de-inferencia-del-lenguaje-viper" title="2.2 Reglas de inferencia del lenguaje Viper" class="md-nav__link">
    2.2 Reglas de inferencia del lenguaje Viper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-que-tienen-que-hacer" title="2.3 ¿Qué tienen que hacer?" class="md-nav__link">
    2.3 ¿Qué tienen que hacer?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-implementacion" title="2.4 Implementación" class="md-nav__link">
    2.4 Implementación
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analisis-de-function" title="Análisis de Function" class="md-nav__link">
    Análisis de Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constantes" title="Constantes" class="md-nav__link">
    Constantes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operaciones-aritmeticas" title="Operaciones Aritméticas" class="md-nav__link">
    Operaciones Aritméticas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return" title="Return" class="md-nav__link">
    Return
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-autograder" title="2.5 Autograder" class="md-nav__link">
    2.5 Autograder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/CC-4/edit/master/page/es/docs/laboratorios/lab-6-analisis-semantico-i.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="lab-6-40analisis-semantico-i41">Lab 6 (Análisis Semántico I)<a class="headerlink" href="#lab-6-40analisis-semantico-i41" title="Permanent link">&para;</a></h1>
<p>Es hora de empezar a poner en práctica el análisis semántico. El motivo de este laboratorio es que puedan ganar experiencia en como se hace el análisis semántico de un lenguaje simple y que posteriormente en su proyecto plasmen estas ideas. En el laboratorio anterior se enteraron de como funcionaba la tabla de símbolos, en este la vamos a utilizar juntamente con otras herramientas para anotar el árbol (<em>AST</em>) de un lenguaje llamado <strong>Viper</strong> con los tipos correspondientes.</p>
<p>Antes de empezar, vamos a obtener los archivos necesarios desde Github Classroom:</p>
<div class="codehilite"><pre><span></span>https://classroom.github.com/a/r35tEC0W
</pre></div>

<p><strong>Por favor lean todas las instrucciones del lab, antes de empezar.</strong></p>
<h2 id="1-ciclos-en-grafos">1. Ciclos en Grafos:<a class="headerlink" href="#1-ciclos-en-grafos" title="Permanent link">&para;</a></h2>
<p>En la fase 3 del compilador les piden verificar que el grafo de herencia de un programa hecho en <strong>COOL</strong> esté bien formado. Según la definición del manual de COOL un grafo de herencia está bien formado si ese grafo <strong>NO</strong> tiene ciclos, es decir, si hay una clase <strong>A</strong>, esa clase <strong>A</strong> no puede heredar de <strong>A</strong> (de ella misma). Tampoco se puede que una clase <strong>A</strong> herede de una clase <strong>B</strong> y esa clase <strong>B</strong> herede de <strong>A</strong>. Para poder encontrar esos ciclos necesitamos diseñar un algoritmo <em><strong>recursivo</strong></em> (<em>lo que van a hacer en esta primera parte del lab</em>). En el archivo <strong>src/Graph.java</strong> hay una función llamada <em><strong>hasCycles</strong></em> que tienen que completar para encontrar los ciclos en un grafo:</p>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Checks if a class has cycles.</span>
<span class="cm"> *</span>
<span class="cm"> * @param name class name</span>
<span class="cm"> * @param visted visited classes set</span>
<span class="cm"> * @return true if the class has cycles, false if not</span>
<span class="cm"> */</span>
<span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">hasCycles</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">visited</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// WRITE YOUR CODE HERE</span>
  <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>

<p>Una buena idea para almacenar el grafo de <em><strong>herencia</strong></em> es usar un <strong>hashtable</strong> <em>(la mayoría de cosas en este proyecto sale con hashtables...)</em>, ya que podemos guardar una relación padre -&gt; hijos. Lo que hace el método de la clase <code>add(String parent, LinkedList&lt;String&gt; children)</code>. En este caso estamos usando <code>Strings</code> en vez de <code>AbstractSymbols</code> solo para simplificar las cosas. Entonces si uno quiere saber si una clase tiene ciclos mandaríamos a llamar al método <code>hasCycles("algunaclase")</code>. Cuando logren implementar este ejercicio, va a ser bastante fácil trasladar este código a su proyecto.</p>
<h3 id="11-que-tienen-que-hacer">1.1 ¿Qué tienen que hacer?<a class="headerlink" href="#11-que-tienen-que-hacer" title="Permanent link">&para;</a></h3>
<p>Ustedes tienen que diseñar un algoritmo <em><strong>recursivo</strong></em> que sea capaz de verificar si una clase tiene ciclos en su <em><strong>path</strong></em> de herencia, pero primero algunas aclaraciones:</p>
<ol>
<li>Recuerden que estamos trabajando con <code>Strings</code> , no con <code>AbstractSymbols</code>.</li>
<li>Una clase no puede heredar de ella misma o sus parents de ellos mismos.</li>
<li>NO hay circuitos cerrados de herencia, siempre hay nodos sueltos en un grafo bien formado.</li>
<li><strong>TIENE</strong> que ser recursivo (queda bastante simple así, lo prometemos).</li>
</ol>
<p>Para que tengan una referencia, de que tanto tendrían que agregar al archivo, aquí están las estadísticas de nuestra implementación:</p>
<div class="codehilite"><pre><span></span> src/Graph.java <span class="p">|</span> <span class="m">10</span> ++++++++++
 <span class="m">1</span> file changed, <span class="m">10</span> insertions<span class="o">(</span>+<span class="o">)</span>
</pre></div>

<h3 id="12-autograder">1.2 Autograder<a class="headerlink" href="#12-autograder" title="Permanent link">&para;</a></h3>
<p>Para probar su implementación pueden utilizar lo siguiente</p>
<div class="codehilite"><pre><span></span>./check cycles
</pre></div>

<p>Si todo lo tienen bien, les debería de salir lo siguiente:</p>
<div class="codehilite"><pre><span></span>      Autograder


+1       <span class="o">(</span>test1<span class="o">)</span>       
+1       <span class="o">(</span>test5<span class="o">)</span>       
+1       <span class="o">(</span>test2<span class="o">)</span>       
+1       <span class="o">(</span>test4<span class="o">)</span>       
+1       <span class="o">(</span>test6<span class="o">)</span>       
+1       <span class="o">(</span>test3<span class="o">)</span>       


<span class="o">=</span>&gt; You got a score of <span class="m">6</span> out of <span class="m">6</span>.
</pre></div>

<p>El autograder funciona como en los proyectos, pueden ver en la carpeta <strong>grading</strong> las diferencias y los tests que se están probando. Si ustedes desean probar en un archivo en específico pueden hacer lo siguiente:</p>
<div class="codehilite"><pre><span></span>./gradlew build
./run -cycles &lt;archivo&gt;
</pre></div>

<p>En la carpeta <strong>examples/cycles</strong> hay algunos ejemplos. La estructura de los archivos de prueba es bastante simple:</p>
<div class="codehilite"><pre><span></span>parent -&gt; children
parent -&gt; children
...
</pre></div>

<p>Por ejemplo:</p>
<div class="codehilite"><pre><span></span>Object -&gt; Main, IO, String, Int
Main -&gt; A
</pre></div>

<p>Noten que los nodos sueltos <strong>no</strong> se definen (como <strong>A</strong>).</p>
<h2 id="2-analisis-semantico-del-lenguaje-viper">2. Análisis Semántico del lenguaje Viper<a class="headerlink" href="#2-analisis-semantico-del-lenguaje-viper" title="Permanent link">&para;</a></h2>
<p>Para el ejercicio 2 haremos el análisis semántico de algunos nodos del lenguaje Viper, así que los introduciremos a el un poco.</p>
<h3 id="21-lenguaje-viper">2.1 Lenguaje Viper<a class="headerlink" href="#21-lenguaje-viper" title="Permanent link">&para;</a></h3>
<p><strong>Viper</strong> es un lenguaje bastante básico, es una mezcla de python y C, pero tiene características importantes para fines didácticos así que lo estaremos utilizando en este laboratorio y en los posteriores para terminar su análisis semántico y para realizar su <strong>generación de código</strong>, por eso sería bueno que se acostumbren un poco al lenguaje. </p>
<p>La mejor forma de entender este lenguaje es revisando la gramática dentro de la carpeta del lab está una subcarpeta llamada <strong>doc</strong> donde está en formato PDF llamada <strong>Viper_Language_Grammar.pdf</strong>. Una vez hayan visto/entendido la gramática, esto les parecera conocido:</p>
<div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="nb">int</span> <span class="p">{</span>
      <span class="nb">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="n">result</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
</pre></div>

<h3 id="22-reglas-de-inferencia-del-lenguaje-viper">2.2 Reglas de inferencia del lenguaje Viper<a class="headerlink" href="#22-reglas-de-inferencia-del-lenguaje-viper" title="Permanent link">&para;</a></h3>
<p><strong>Viper</strong> tiene pocas reglas de inferencia a comparación de <strong>COOL</strong> y son menos complejas, sin embargo ayudan a entender bastante la dinámica de lo que tendrían que hacer en el proyecto, solo que sin objetos. Para ver estas reglas, pueden descargar el siguiente archivo:</p>
<p><a href="/semant/viper_language_type_rules.pdf">Reglas de inferencia Viper</a></p>
<p>También pueden encontrar este archivo en la subcarpeta <strong>doc</strong> de su laboratorio con el nombre <strong>Viper_Language_Type_Rules.pdf</strong>. Lo importante es que en ese documento están las reglas en el mismo formato que el manual de <strong>COOL</strong>, solo que en español y que son para el lenguaje <strong>Viper</strong> obviamente.</p>
<h3 id="23-que-tienen-que-hacer">2.3 ¿Qué tienen que hacer?<a class="headerlink" href="#23-que-tienen-que-hacer" title="Permanent link">&para;</a></h3>
<p>En los archivos de lab dentro de <strong>src/viper/tree</strong> están los nodos que representan el AST de un programa de Viper. En algunos de estos nodos ustedes tendrán que realizar el análisis semántico para completar el laboratorio. Los nodos que tienen que analizar son los siguientes:</p>
<ol>
<li><strong>Function</strong></li>
<li><strong>BoolConst</strong></li>
<li><strong>IntConst</strong></li>
<li><strong>StrConst</strong></li>
<li><strong>Add</strong></li>
<li><strong>Sub</strong></li>
<li><strong>Mul</strong></li>
<li><strong>Div</strong></li>
<li><strong>Mod</strong></li>
<li><strong>Return</strong></li>
</ol>
<p>En el lenguaje Viper existen <em>statements</em> y <em>expressions</em>, solo las expresiones son las que siempre devuelven un valor y se les asigna un tipo, los statements no. Para asignar un tipo a una expresión vean la función <strong>semant</strong> del nodo <strong>NoReturn</strong> para ver como es que se le asigna un tipo a una expresión utilizando la clase <strong>Type</strong>, además vean la clase <strong>Type</strong> para ver los métodos que tiene, porque les va a servir tenerlos en mente. También van a notar como está declarada la función <code>semant</code> en los nodos del AST:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">semant</span><span class="o">(</span><span class="n">SymbolTable</span> <span class="n">O</span><span class="o">,</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Function</span><span class="o">&gt;</span> <span class="n">M</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// WRITE YOUR CODE HERE</span>
<span class="o">}</span>
</pre></div>

<p><code>O</code> es la tabla de símbolos que utilizaron en el laboratorio anterior, <code>M</code>es el entorno de funciones que hace un mapping de nombre de función a <code>Function</code> (<em>esto es útil porque así se puede extraer fácilmente los formals y el tipo de retorno</em>). Algo así tendría que verse su método <code>semant</code> en su proyecto, solo que con las cosas de COOL y tomando en cuenta los nombres de clases y que son <code>AbstractSymbol</code>. En este laboratorio no vamos a utilizar a <code>M</code>.</p>
<p>Para que tengan una referencia, de que tanto tendrían que agregar a los diferentes archivos, aquí están las estadísticas de nuestra implementación:</p>
<div class="codehilite"><pre><span></span> src/viper/tree/Add.java       <span class="p">|</span>  <span class="m">7</span> ++++++-
 src/viper/tree/BoolConst.java <span class="p">|</span>  <span class="m">2</span> +-
 src/viper/tree/Div.java       <span class="p">|</span>  <span class="m">7</span> ++++++-
 src/viper/tree/Function.java  <span class="p">|</span> <span class="m">30</span> +++++++++++++++++++++++++++++-
 src/viper/tree/IntConst.java  <span class="p">|</span>  <span class="m">4</span> ++--
 src/viper/tree/Mod.java       <span class="p">|</span>  <span class="m">7</span> ++++++-
 src/viper/tree/Mul.java       <span class="p">|</span>  <span class="m">7</span> ++++++-
 src/viper/tree/Return.java    <span class="p">|</span>  <span class="m">3</span> ++-
 src/viper/tree/StrConst.java  <span class="p">|</span>  <span class="m">4</span> ++--
 src/viper/tree/Sub.java       <span class="p">|</span>  <span class="m">7</span> ++++++-
 <span class="m">10</span> files changed, <span class="m">66</span> insertions<span class="o">(</span>+<span class="o">)</span>, <span class="m">12</span> deletions<span class="o">(</span>-<span class="o">)</span>
</pre></div>

<h3 id="24-implementacion">2.4 Implementación<a class="headerlink" href="#24-implementacion" title="Permanent link">&para;</a></h3>
<p>Para cada nodo del AST hay una serie de pasos que se tienen que realizar para garantizar que el análisis semántico capture todos los errores posibles, recuerden que esta es nuestra última barrera antes de <strong>codegen</strong> para atrapar errores.</p>
<h4 id="analisis-de-function">Análisis de Function<a class="headerlink" href="#analisis-de-function" title="Permanent link">&para;</a></h4>
<p>El análisis de las funciones es lo más complejo que realizarán de este laboratorio. Recuerden que como se pueden declarar parámetros formales y variables dentro de una función, esta crea un <strong>scope</strong> nuevo, utilicen lo siguiente para crear un nuevo scope:</p>
<div class="codehilite"><pre><span></span><span class="n">O</span><span class="o">.</span><span class="na">enterScope</span><span class="o">()</span>
</pre></div>

<p><strong>HINT:</strong> Por lo general podemos decir que en Viper cada par de llaves <code>{}</code> crean un nuevo <strong>scope</strong></p>
<p>Si la función se llama <strong>main</strong> hay un par de cosas que se tienen que considerar, una de ellas es que la función <strong>main</strong> no puede tener parámetros definidos y la otra es que siempre tiene que tener un tipo de retorno <strong>int</strong>. Cuando sea el caso que tenga parámetros definidos tienen que utilizar lo siguiente para imprimir un error:</p>
<div class="codehilite"><pre><span></span><span class="n">SemantErrors</span><span class="o">.</span><span class="na">mainFunctionShouldHaveNoArgs</span><span class="o">(</span><span class="n">line</span><span class="o">,</span> <span class="n">col</span><span class="o">)</span>
</pre></div>

<p><strong>HINT:</strong> Noten que todos los nodos en Viper tienen definido un <strong>line</strong> y un <strong>col</strong> ya que heredan de la clase <strong>Node</strong>.</p>
<p><strong>HINT:</strong> Utilicen <code>formals.size()</code> para verificar esto</p>
<p>Y cuando tenga un tipo de retorno diferente de <strong>int</strong>, tienen que utilizar lo siguiente:</p>
<div class="codehilite"><pre><span></span><span class="n">SemantErrors</span><span class="o">.</span><span class="na">mainFunctionShouldHaveAnIntRetType</span><span class="o">(</span><span class="n">line</span><span class="o">,</span> <span class="n">col</span><span class="o">)</span>
</pre></div>

<p>Ustedes tienen que agregar los formals al <strong>scope</strong> que acaban de crear, pero ustedes tienen que verificar que los nombres de los parámetros no se repitan, por ejemplo esto estaría incorrecto:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>

<p>Cuando suceda lo anterior tienen que utilizar lo siguiente:</p>
<div class="codehilite"><pre><span></span><span class="n">SemantErrors</span><span class="o">.</span><span class="na">formalIsAlreadyDefined</span><span class="o">(</span><span class="n">formal</span><span class="o">.</span><span class="na">line</span><span class="o">,</span> <span class="n">formal</span><span class="o">.</span><span class="na">col</span><span class="o">,</span> <span class="n">formal</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
</pre></div>

<p><strong>HINT:</strong> Utilicen lo siguiente para agregar el formal al scope actual:</p>
<div class="codehilite"><pre><span></span><span class="n">O</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formal</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="n">formal</span><span class="o">.</span><span class="na">type</span><span class="o">)</span>
</pre></div>

<p>Noten que como valor mandamos el tipo del formal ¿Por qué?</p>
<p><strong>HINT:</strong> <code>formal</code> tiene que ser una instancia de la clase <strong>Formal</strong></p>
<p>Después deberían de mandar a llamar recursivamente a <code>semant</code> para los <code>statements</code> y la expresión de retorno <code>ret</code>. Cuando estas dos llamadas regresen si <code>ret</code> no tiene tipo <strong>void</strong> y la función si, tienen utilizar lo siguiente para reportar el error:</p>
<div class="codehilite"><pre><span></span><span class="n">SemantErrors</span><span class="o">.</span><span class="na">unexpectedReturnValue</span><span class="o">(</span><span class="n">ret</span><span class="o">.</span><span class="na">line</span><span class="o">,</span> <span class="n">ret</span><span class="o">.</span><span class="na">col</span><span class="o">)</span>
</pre></div>

<p>Si <code>ret</code> es <strong>void</strong> y la función tiene un tipo de retorno diferente de <strong>void</strong> utilizar lo siguiente:</p>
<div class="codehilite"><pre><span></span><span class="n">SemantErrors</span><span class="o">.</span><span class="na">missingReturnStatement</span><span class="o">(</span><span class="n">line</span><span class="o">,</span> <span class="n">col</span><span class="o">)</span>
</pre></div>

<p>Y en general si <code>ret</code> no es igual al tipo de retorno de la función entonces:</p>
<div class="codehilite"><pre><span></span><span class="n">SemantErrors</span><span class="o">.</span><span class="na">incompatibleTypes</span><span class="o">(</span><span class="n">ret</span><span class="o">.</span><span class="na">line</span><span class="o">,</span> <span class="n">ret</span><span class="o">.</span><span class="na">col</span><span class="o">,</span> <span class="n">ret</span><span class="o">.</span><span class="na">getType</span><span class="o">(),</span> <span class="n">type</span><span class="o">)</span>
</pre></div>

<p>Al finalizar el análisis deberían de cerrar el scope, para evitar otros errores:</p>
<div class="codehilite"><pre><span></span><span class="n">O</span><span class="o">.</span><span class="na">exitScope</span><span class="o">()</span>
</pre></div>

<h4 id="constantes">Constantes<a class="headerlink" href="#constantes" title="Permanent link">&para;</a></h4>
<p>Esto es bastante sencillo, si es una constante entera, el tipo de la expresión es <strong>int</strong>. Lo mismo pasa con las demás constantes, strings <strong>str</strong> y booleans <strong>bool</strong>.</p>
<h4 id="operaciones-aritmeticas">Operaciones Aritméticas<a class="headerlink" href="#operaciones-aritmeticas" title="Permanent link">&para;</a></h4>
<p>Primero tienen que mandar a llamar recursivamente a <code>semant</code> de las expresiones que conforman el nodo. Las operaciones aritméticas siempre tienen que tener operandos de tipo <strong>int</strong> y siempre devuelven como resultado un <strong>int</strong>. Cuando algún operando no sea de tipo <strong>int</strong> tienen que utilizar el siguiente errror:</p>
<div class="codehilite"><pre><span></span><span class="n">SemantErrors</span><span class="o">.</span><span class="na">badOperandTypesForBinaryOp</span><span class="o">(</span><span class="n">line</span><span class="o">,</span> <span class="n">col</span><span class="o">,</span> <span class="n">operator</span><span class="o">)</span>
</pre></div>

<p><strong>HINT:</strong> <code>operator</code> tiene que ser un <strong>String</strong> que represente la operación binaria, por ejemplo <code>"+"</code></p>
<p>Siempre tienen que asumir que el tipo de una expresión aritmética es un <strong>int</strong>, de lo contrario nos encontrariamos con errores en cascada poco informativos, consideren lo siguiente:</p>
<div class="codehilite"><pre><span></span><span class="nb">true</span> + <span class="m">2</span> + <span class="m">2</span> + <span class="m">2</span>
</pre></div>

<p>Si no asumieramos lo de arriba pasaría lo siguiente:</p>
<div class="codehilite"><pre><span></span>bad operand types for binary operator &#39;+&#39;
bad operand types for binary operator &#39;+&#39;
bad operand types for binary operator &#39;+&#39;
</pre></div>

<p>A pesar que solo el primer operando de esa serie de sumas es el incorrecto. Lo correcto sería desplegar lo siguiente:</p>
<div class="codehilite"><pre><span></span>bad operand types <span class="k">for</span> binary operator <span class="s1">&#39;+&#39;</span>
</pre></div>

<p>Esto es una forma de recuperación de errores que también van a tener que realizar en su proyecto.</p>
<h4 id="return">Return<a class="headerlink" href="#return" title="Permanent link">&para;</a></h4>
<p>Cuando hagan el análisis semántico de <strong>Return</strong> recuerden que el tipo del return es el mismo que el de la expresión <code>e</code> del return.</p>
<h3 id="25-autograder">2.5 Autograder<a class="headerlink" href="#25-autograder" title="Permanent link">&para;</a></h3>
<p>Para probar su implementación pueden utitlizar lo siguiente:</p>
<div class="codehilite"><pre><span></span>./check viper
</pre></div>

<p>Si todo lo tienen bien, les debería de salir lo siguiente:</p>
<div class="codehilite"><pre><span></span>      Autograder


+1 <span class="o">(</span>unexpectedreturn<span class="o">)</span>  
+1    <span class="o">(</span>diffrettype<span class="o">)</span>    
+1       <span class="o">(</span>arith<span class="o">)</span>       
+1   <span class="o">(</span>mainwithargs<span class="o">)</span>    
+1       <span class="o">(</span>basic<span class="o">)</span>       
+1     <span class="o">(</span>badarith<span class="o">)</span>      
+1     <span class="o">(</span>mainnoint<span class="o">)</span>     
+1       <span class="o">(</span>good<span class="o">)</span>        
+1    <span class="o">(</span>badformals<span class="o">)</span>     
+1      <span class="o">(</span>string<span class="o">)</span>       
+1       <span class="o">(</span>bool<span class="o">)</span>        
+1    <span class="o">(</span>missingret<span class="o">)</span>     


<span class="o">=</span>&gt; You got a score of <span class="m">12</span> out of <span class="m">12</span>.
</pre></div>

<p>Si ustedes desean probar en un archivo en específico pueden hacer lo siguiente:</p>
<div class="codehilite"><pre><span></span>./gradlew build
./run -viper &lt;archivo&gt;
</pre></div>

<p>En la carpeta <strong>examples/viper</strong> hay algunos ejemplos.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../lab-5/" title="Lab 5 (Symbol Table)" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                Lab 5 (Symbol Table)
              </span>
            </div>
          </a>
        
        
          <a href="../lab-7-analisis-semantico-ii/" title="Lab 7 (Análisis Semántico II)" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                Lab 7 (Análisis Semántico II)
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            CC-4
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/CC-4" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b41f3d20.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../../assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../js/latex.js"></script>
      
        <script src="../../js/python.js"></script>
      
    
    
      
    
  </body>
</html>